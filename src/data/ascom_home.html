<!doctype html>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
   	<title>AstroWeatherStation ASCOM Setup</title>
	<style>
		.night {
			font-family: arial;
			color: red;
			background: black;
		}
		table {
			border-collapse: collapse;
			border: 2px solid;
		}
		td {
			border: 1px solid;
			padding: 6px;
		}
	</style>
</head>
<body class="night" onload="initialise_page()">

<h1 style="font-size=14pt">AstroWeatherStation ASCOM ALPACA Server setup</h1>
<form id="config" method="POST"></form>
<table>
	<tr><th></tr>
	<tr><td>Name</td><td>AstroWeatherStation</td></tr>
	<tr><td>Manufacturer</td><td>Lesage F. (lesage@datamancers.net)</td></tr>
	<tr><td>WiFi Mode</td><td id="wifi_mode"><input id="ap" form="config" name="wifi_mode" value="AP" type="radio"/> AP <input id="client" form="config" name="wifi_mode" value="Client" type="radio"/> Client</td></tr>
	<tr><td>WiFi SSID</td><td><input id="wifi_ssid" form="config" type="text" name="wifi_ssid" value="" size="15"/></td></tr>
	<tr><td>WiFi IP</td><td><input id="wifi_ip" form="config" type="text" name="wifi_ip" value="" size="8"/></td></tr>
	<tr><td>WiFi Port</td><td id="wifi_port"></td></tr>
	<tr id="ethernet_1" style="display:none"><td>Ethernet IP</td><td><input id="eth_ip" form="config" Â¨type="text" name="eth_ip" value="" size="8"/></td></tr>
	<tr id="ethernet_2" style="display:none"><td>Ethernet Port</td><td id="eth_port"></td></tr>
	<tr><td>ALPACA Discovery service</td><td id="discovery_svc"></td></tr>
	<tr><td>ALPACA Discovery port </td><td id="discovery_port"></td></tr>
	<tr><td>Information</td><td><a href="https://github.com/switux/AstroWeatherStation">GitHub page</a></td></tr>
	<caption> </caption>
</table>
<button onclick="reboot()">Reboot station</button>
<script>
	
function reboot()
{
}
	
function initialise_page()
{
	req = new XMLHttpRequest();
	req.onreadystatechange = function() {
		if ( this.readyState == 4 && this.status == 200 ) {
			values = JSON.parse( req.responseText );
/*			switch( values['wifi_mode'] ) {
				case 'AP':
					document.getElementById("AP").checked = true;
					break;
				case 'Client':
					document.getElementById("Client").checked = true;
					break;
				case 'Both':
					document.getElementById("Both").checked = true;
					break;
			}
*/
			document.getElementById("wifi_ip").value = values['wifi_ip'];
			if ( values['has_ethernet'] ) {

				document.getElementById("ethernet_1").style.display = 'inline';
				document.getElementById("ethernet_2").style.display = 'inline';
				document.getElementById("eth_ip").value = values['eth_ip'];
				
			} else {

				document.getElementById("ethernet_1").style.display = 'none';
				document.getElementById("ethernet_2").style.display = 'none';
				document.getElementById("eth_ip").innerHTML = '0.0.0.0';
				document.getElementById("eth_port").innerHTML = '0';
			}
			
/*			document.getElementById("tzname").value = values['tzname'];
			document.getElementById("ssid").value = values['ssid'];
			document.getElementById("wifi_password").value = values['password'];
			document.getElementById("remote_server").value = values['remote_server'];
			document.getElementById("url_path").value = values['url_path'];
			document.getElementById("has_bme").checked = values['has_bme'];
			document.getElementById("has_tsl").checked = values['has_tsl'];
			document.getElementById("has_mlx").checked = values['has_mlx'];
			document.getElementById("has_ws").checked = values['has_ws'];
			document.getElementById("has_wv").checked = values['has_wv'];
			document.getElementById("has_rg9").checked = values['has_rg9'];
			document.getElementById("has_gps").checked = values['has_gps'];*/
			console.log( values );
		}
	};
	req.open( "GET", "/get_config", true );
	req.send();
}
</script>
<br>
<hr>
<p>&copy; Lesage F. / 2023
</body>
</html>
